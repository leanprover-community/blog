<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Adventure 10000 | Lean community blog</title>
<link href="../../assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/theme.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/custom.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css2?family=Merriweather&amp;family=Open+Sans&amp;family=Source+Code+Pro:wght@400;600&amp;display=swap" rel="stylesheet">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../rss.xml">
<link rel="canonical" href="https://leanprover-community.github.io/blog/posts/adventure-10000/">
<link rel="icon" href="https://leanprover-community.github.io/img/favicon.ico" sizes="48x48">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://leanprover-community.github.io/blog/meta-twitter.png">
<meta name="twitter:title" content="Adventure 10000 | Lean community blog">
<meta name="author" content="Yury Kudryashov">
<link rel="prev" href="../month-in-mathlib/2022/month-in-mathlib-jan-2022/" title="This month in mathlib (Jan 2022)" type="text/html">
<link rel="next" href="../month-in-mathlib/2022/month-in-mathlib-feb-2022/" title="This month in mathlib (Feb 2022)" type="text/html">
<meta property="og:site_name" content="Lean community blog">
<meta property="og:title" content="Adventure 10000">
<meta property="og:url" content="https://leanprover-community.github.io/blog/posts/adventure-10000/">
<meta property="og:description" content="About a month ago, the Cauchy integral
theorem
for some simple domains
landed
in mathlib. PR number 10000 was specially allocated for this occasion
in advance. In this post I will recollect the events">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2022-02-10T18:46:20+02:00">
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <div id="container">
            <header id="header"><h1 id="brand"><a href="../../" title="Lean community blog" rel="home">

        <span id="blog-title">Lean community blog</span>
    </a></h1>

        
            <nav id="menu"><ul>
<li><a href="https://leanprover-community.github.io/">Main site</a></li>
                <li><a href="../../archive.html">Archive</a></li>
                <li><a href="../../categories/">Tags</a></li>
                <li><a href="../../about/">About</a></li>
                <li><a href="../../rss.xml">RSS feed</a></li>

    
    
    
    </ul></nav></header><main id="content"><article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Adventure 10000</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                        <a class="u-url" href="../../authors/yury-kudryashov/">Yury Kudryashov</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2022-02-10T18:46:20+02:00" itemprop="datePublished" title="2022-02-10 18:46">2022-02-10 18:46</time></a>
            </p>
                    <p class="sourceline"><a href="https://github.com/leanprover-community/blog/tree/deploy/docs/posts/adventure-10000/index.md" class="sourcelink">Source</a></p>

        </div>
        
    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<p>About a month ago, the <a href="https://en.wikipedia.org/wiki/Cauchy%27s_integral_theorem">Cauchy integral
theorem</a>
for some simple domains
<a href="https://github.com/leanprover-community/mathlib/pull/10000">landed</a>
in mathlib. PR number 10000 was specially allocated for this occasion
in advance. In this post I will recollect the events that led to this
formalization.</p>
<!-- TEASER_END -->

<p>Unlike all other formalizations of the Cauchy integral formula, this
one is based on a very general version of the <a href="https://en.wikipedia.org/wiki/Divergence_theorem">divergence
theorem</a>. I discuss
the technical decisions behind this formalization in a
<a href="https://github.com/urkud/divthm-paper">paper</a> I have recently
submitted to the ITP conference.</p>
<p>The simplest version of the divergence theorem says that for a
continuously differentiable vector field $v$ on a rectangular box $I$
in $ℝ^n$, the integral of the divergence $\operatorname{div} v$ over
$I$ is equal to the flux of $v$ through the boundary of $I$, where the
flux of $v$ through $i$-th front (resp., back) face of $I$ is defined
as plus (resp., minus) the integral of $v_i$ over this face.</p>
<p>The Cauchy integral theorem (a.k.a. the Cauchy-Goursat theorem) states
that the integral $\oint_\gamma f(z)\,dz$ is equal to zero provided
that $f$ is complex differentiable in the domain bounded by
$\gamma$. For simplicity, let us consider only rectangular domains.</p>
<p>If $f:ℂ → ℂ$ is <em>continuously differentiable</em> on this rectangle, then
the Cauchy-Goursat theorem for $f$ on this rectangle follows from the
divergence theorem applied to the vector field $v_{f}(x,
y)=(\operatorname{Re} f(x+iy), -\operatorname{Im} f(x+iy))$.</p>
<p>Many students (including me) were taught that this argument can't be
patched to work for any differentiable function, and one has to use a
trick specific to complex analysis (e.g., an explicit infinite descent
on triangles). In October 2020, we <a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/Single.20variable.20complex.20analysis">had a chat on
Zulip</a>
about formalization of complex analysis, where Patrick Massot
<a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/Single.20variable.20complex.20analysis/near/214237436">shared</a>
a link to a
<a href="https://link.springer.com/article/10.1007/BF03024304">paper</a> by
Felipe Acker where Felipe proves the divergence theorem for a
differentiable vector field with continuous divergence. The vector
field $v_f$ introduced above has divergence zero, hence this version
of the divergence theorem implies the Cauchy-Goursat theorem.</p>
<p>I started formalizing a simplified version of Acker's proof right
away, and had a draft version by November 2020. Later I dropped this
version, but some traces of this attempt can be found in
<a href="https://github.com/leanprover-community/mathlib/pull/4913">this</a>
abandoned pull request.</p>
<p>Once I had the first draft, I realized that the proof reminded me of
the proof of the Fundamental Theorem of Calculus for the
Henstock-Kurzweil integral. I had heard about this integral when I
was a student at the Moscow State University, and some of my
classmates complained that their professor Lukashenko<sup id="fnref:MSU"><a class="footnote-ref" href="#fn:MSU">1</a></sup> made them
study the useless Henstock integral as a part of a standard 1st year
analysis course.</p>
<p>So, I opened some old lecture notes written by my classmates,
refreshed my knowledge of the Henstock integral, and realized that
actually I prove that the divergence is integrable in the sense of one
of possible generalizations of this integral to $ℝ^n$. Thus I decided
to formalize the Henstock integral in Lean and split the proof into
two parts: the divergence theorem for a Henstock-like integral that
required no regularity from the divergence, and a proof of the fact
that any Bochner integrable function is Henstock integrable.</p>
<p>During most of 2021 I worked on other projects but in the fall I came back to
the divergence theorem and formalized it. The university library was
closed because of the pandemic and I failed to find a good source on the
multivariable Henstock integral online, so I had to generalize
theorems myself.</p>
<p>The most difficult part was to formalize the notion of a
Henstock/McShane/Riemann integral (it took more than 4000 lines) and
figure out what parts of the one-dimensional proofs I had at hand work
in the multivariable settings.</p>
<p>In October 2021, I formalized the divergence theorem for a
Henstock-style integral and by the first days of January I had the
Cauchy-Goursat theorem. This opened a door to formalization of other
topics in complex analysis, and I have already formalized the Riemann
removable singularity theorem
(<a href="https://github.com/leanprover-community/mathlib/pull/11686">merged</a>)
and the maximum modulus principle (<a href="https://github.com/leanprover-community/mathlib/pull/10978">pending API update and
review</a>). Moreover,
Jireh Loreaux already used my new additions to the library to
<a href="https://github.com/leanprover-community/mathlib/pull/11916">prove</a>
Gelfand's formula for the spectral radius, pending review.</p>
<p>In January 2022, I decided to write an ITP paper about this
project. While searching for references for the paper, I found a
<a href="https://doi.org/10.1016/B978-044450263-6/50014-2">survey by Benedetto
Bongiorno</a>. I still
can't understand why I didn't find this survey half a year earlier
(I found it by googling for something like "Henstock integral
divergence theorem"). I read the survey and found out that the version
of the Henstock-Kurzweil integral I used in the project was introduced
by Mawhin about 5 years before I was born, and there are several more
advanced definitions that allow us to prove the divergence theorem
with even weaker assumptions (e.g., with one of the integrals one can
replace the differentiability assumption by continuity on a <em>countable
set of hyperplanes</em>).</p>
<p>For a few days, I was unsure whether I should proceed with my paper or
implement one of these integrals first. Then I decided to write about
the completed project and write about other integrals in the "Future
plans" section.</p>
<div class="footnote">
<hr>
<ol>
<li id="fn:MSU">
<p>The undergraduate education at MSU (and most other Russian
universities) is very different from what you see on the
West. Different majors have separate entrance exams (it is
possible but not at all trivial to change one's from math major to
CS or economics) and most of the courses for the first 2-3 years
are determined by the student's major. Moreover, the students are
distributed into groups of about 20-25 people, and students from
one group go to the same section of each course. All ~300 of math
major freshmen have to take proof-based courses in Analysis,
Algebra, and Linear Algebra. <a class="footnote-backref" href="#fnref:MSU" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul class="pager hidden-print">
<li class="previous">
                <a href="../month-in-mathlib/2022/month-in-mathlib-jan-2022/" rel="prev" title="This month in mathlib (Jan 2022)">Previous post</a>
            </li>
            <li class="next">
                <a href="../month-in-mathlib/2022/month-in-mathlib-feb-2022/" rel="next" title="This month in mathlib (Feb 2022)">Next post</a>
            </li>
        </ul></nav></aside><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
    },
    displayAlign: 'center', // Change this to 'left' if you want left-aligned equations.
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}}
    }
});
</script></article><script src="https://giscus.app/client.js" data-repo="leanprover-community/blog" data-repo-id="MDEwOlJlcG9zaXRvcnkzOTM3OTE1ODU=" data-category="Announcements" data-category-id="DIC_kwDOF3jIYc4CQntU" data-mapping="og:title" data-strict="1" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="light" data-lang="en" crossorigin="anonymous" async>
        </script></main><footer id="footer"><p>Contents © 2025         The Lean prover community - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         </p>
            
        </footer>
</div>
        


    <!-- Mermaid JS for diagram rendering -->
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true });
    </script>
</body>
</html>
